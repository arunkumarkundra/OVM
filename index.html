<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OVM Assessment - Discover Your Optimization Profile</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
            max-width: 700px;
            width: 100%;
            min-height: 500px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .screen {
            display: none;
            flex: 1;
        }

        .screen.active {
            display: flex;
            flex-direction: column;
        }

        /* Welcome Screen */
        .welcome-screen {
            padding: 60px 40px;
            text-align: center;
            justify-content: center;
        }

        .welcome-screen h1 {
            color: #2d3748;
            font-size: 2.5rem;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .welcome-screen .subtitle {
            color: #667eea;
            font-size: 1.2rem;
            margin-bottom: 30px;
            font-weight: 600;
        }

        .welcome-screen p {
            color: #4a5568;
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .start-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1rem;
            border-radius: 50px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-top: 20px;
        }

        .start-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        /* Progress Bar */
        .progress-container {
            height: 8px;
            background: #e2e8f0;
            position: relative;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            width: 0%;
            transition: width 0.3s ease;
        }

        .progress-text {
            padding: 20px 40px 0;
            color: #4a5568;
            font-size: 0.9rem;
            text-align: center;
        }

        /* Question Screen */
        .question-screen {
            padding: 40px;
            justify-content: center;
        }

        .question-card {
            text-align: center;
        }

        .question-card h2 {
            color: #2d3748;
            font-size: 1.5rem;
            margin-bottom: 40px;
            line-height: 1.4;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .option {
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
        }

        .option:hover {
            border-color: #667eea;
            background: #edf2f7;
            transform: translateY(-2px);
        }

        .option-text {
            color: #2d3748;
            font-size: 1rem;
            line-height: 1.4;
        }

        /* Results Screen */
        .results-screen {
            padding: 40px;
            overflow-y: auto;
        }

        .results-title {
            color: #2d3748;
            font-size: 2rem;
            text-align: center;
            margin-bottom: 30px;
        }

        .result-section {
            margin-bottom: 30px;
            padding: 25px;
            background: #f7fafc;
            border-radius: 15px;
        }

        .result-section h3 {
            color: #667eea;
            font-size: 1.3rem;
            margin-bottom: 15px;
        }

        .archetype-type {
            font-size: 2.5rem;
            font-weight: bold;
            color: #764ba2;
            text-align: center;
            margin: 20px 0;
        }

        .trait-bar {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .trait-label {
            width: 140px;
            font-weight: 600;
            color: #2d3748;
        }

        .trait-progress {
            flex: 1;
            height: 12px;
            background: #e2e8f0;
            border-radius: 6px;
            margin: 0 15px;
            overflow: hidden;
        }

        .trait-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-radius: 6px;
            transition: width 0.8s ease;
        }

        .trait-score {
            width: 40px;
            text-align: center;
            font-weight: 600;
            color: #4a5568;
        }

        .recommendations {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .rec-column {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .rec-column.avoid {
            border-left-color: #e53e3e;
        }

        .rec-column h4 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .rec-column ul {
            list-style: none;
            padding: 0;
        }

        .rec-column li {
            color: #4a5568;
            margin-bottom: 8px;
            padding-left: 20px;
            position: relative;
        }

        .rec-column li:before {
            content: "✓";
            position: absolute;
            left: 0;
            color: #48bb78;
            font-weight: bold;
        }

        .rec-column.avoid li:before {
            content: "⚠";
            color: #e53e3e;
        }

        .message-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 30px;
        }

        .message-section textarea {
            width: 100%;
            min-height: 100px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            color: white;
            padding: 15px;
            margin-top: 15px;
            resize: vertical;
            font-family: inherit;
        }

        .message-section textarea::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .export-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .export-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .export-btn:hover {
            background: #5a67d8;
            transform: translateY(-2px);
        }

        .restart-btn {
            background: #e53e3e;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            margin-top: 20px;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }

        .restart-btn:hover {
            background: #c53030;
            transform: translateY(-2px);
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }

            .welcome-screen {
                padding: 40px 30px;
            }

            .welcome-screen h1 {
                font-size: 2rem;
            }

            .question-screen {
                padding: 30px 25px;
            }

            .results-screen {
                padding: 30px 25px;
            }

            .recommendations {
                grid-template-columns: 1fr;
            }

            .export-buttons {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- Welcome Screen -->
        <div class="screen active" id="welcome-screen">
            <div class="welcome-screen">
                <h1>OVM Assessment</h1>
                <div class="subtitle">Optimization Vectors Model</div>
                <p><strong>Discover what truly drives your life choices</strong></p>
                <p>This assessment reveals your optimization profile across five fundamental human drivers: Control, Growth, Status, Belonging, and Purpose. Understanding your unique combination helps you make better decisions about career, relationships, and personal development.</p>
                <p><strong>How it works:</strong> You'll see 25 paired choices. Simply select the option that feels more important to you when making life decisions. There are no right or wrong answers.</p>
                <p><em>Based on the Optimization Vectors Model (OVM) - a scientific framework for understanding human motivation.</em></p>
                <button class="start-btn" onclick="startAssessment()">Start Assessment</button>
            </div>
        </div>

        <!-- Question Screen -->
        <div class="screen" id="question-screen">
            <h1 style="text-align: center; color: #2d3748; font-size: 2rem; margin-bottom: 20px;">OVM Assessment</h1>

            <div class="progress-container">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
            <div class="progress-text" id="progress-text">Question 1 of 25</div>
            <div class="question-screen">
                <div class="question-card">
                    <h2 id="question-text"></h2>
                    <div class="options" id="options-container"></div>
                </div>
            </div>
        </div>

        <!-- Results Screen -->
        <div class="screen" id="results-screen">
            <div class="results-screen">
                <h1 class="results-title">Your Optimization Profile</h1>
                
                <div class="result-section">
                    <h3>Your Archetype</h3>
                    <div class="archetype-type" id="archetype-type"></div>
                    <p id="archetype-description"></p>
                </div>

                <div class="result-section">
                    <h3>Optimization Vector Analysis</h3>
                    <p id="vector-analysis"></p>
                </div>

                <div class="result-section">
                    <h3>Your Optimization Drivers</h3>
                    <div id="optimization-drivers"></div>
                </div>

                <div class="result-section">
                    <h3>Life & Career Insights</h3>
                    <div class="recommendations">
                        <div class="rec-column">
                            <h4>✓ Strengths & Opportunities</h4>
                            <ul id="recommendations-strengths"></ul>
                        </div>
                        <div class="rec-column avoid">
                            <h4>⚠ Potential Blind Spots</h4>
                            <ul id="recommendations-blindspots"></ul>
                        </div>
                    </div>
                </div>

                <div class="message-section">
                    <h3>Your Personal Message</h3>
                    <p>Add your own thoughts or goals based on these insights:</p>
                    <textarea id="personal-message" placeholder="e.g., 'Based on my results, I want to focus more on...' or 'This explains why I feel energized when...'"></textarea>
                </div>

                <div class="result-section">
                    <p style="text-align: center; color: #667eea; font-style: italic;">
                        "Understanding your optimization drivers is the first step to intentional living. Use these insights to make choices that align with your authentic self."
                    </p>
                </div>

                <div class="export-buttons">
                    <button class="export-btn" onclick="downloadResults()">Download</button>
                    <button class="export-btn" onclick="shareAsImage()">Share</button>
                </div>

                <button class="restart-btn" onclick="restartAssessment()">Take Assessment Again</button>
            </div>
        </div>
    </div>

    <script>
        // OVM Questions (25 forced-choice pairs)
        const questions = [
            {
                question: "Would you rather:",
                optionA: { text: "Be completely free to live life on your own terms", driver: "Control" },
                optionB: { text: "Be surrounded by people who love and support you", driver: "Belonging" }
            },
            {
                question: "Would you rather:",
                optionA: { text: "Be known as highly successful and admired", driver: "Status" },
                optionB: { text: "Make a lasting difference in the world", driver: "Purpose" }
            },
            {
                question: "Would you rather:",
                optionA: { text: "Constantly exploring new ideas and skills", driver: "Growth" },
                optionB: { text: "Having a stable, predictable life", driver: "Control" }
            },
            {
                question: "Would you rather:",
                optionA: { text: "Being admired and respected by others", driver: "Status" },
                optionB: { text: "Having deep, reliable personal relationships", driver: "Belonging" }
            },
            {
                question: "Would you rather:",
                optionA: { text: "Discovering new knowledge and experiences", driver: "Growth" },
                optionB: { text: "Devoting myself to a cause I believe in", driver: "Purpose" }
            },
            {
                question: "In making life choices, what matters more:",
                optionA: { text: "Having complete independence in decisions", driver: "Control" },
                optionB: { text: "Never being lonely or isolated", driver: "Belonging" }
            },
            {
                question: "In making life choices, what matters more:",
                optionA: { text: "Outperforming peers and gaining recognition", driver: "Status" },
                optionB: { text: "Living in line with my values and ideals", driver: "Purpose" }
            },
            {
                question: "In making life choices, what matters more:",
                optionA: { text: "Seeking challenges that push me beyond comfort", driver: "Growth" },
                optionB: { text: "Reducing risks and maintaining security", driver: "Control" }
            },
            {
                question: "In making life choices, what matters more:",
                optionA: { text: "Standing out as exceptional", driver: "Status" },
                optionB: { text: "Being embraced as 'one of us'", driver: "Belonging" }
            },
            {
                question: "In making life choices, what matters more:",
                optionA: { text: "Pursuing mastery for its own sake", driver: "Growth" },
                optionB: { text: "Living for something larger than myself", driver: "Purpose" }
            },
            {
                question: "What drives you more:",
                optionA: { text: "Avoiding constraints or rules from others", driver: "Control" },
                optionB: { text: "Being accepted as part of a close group", driver: "Belonging" }
            },
            {
                question: "What drives you more:",
                optionA: { text: "Earning high prestige and influence", driver: "Status" },
                optionB: { text: "Staying true to my principles, even if unnoticed", driver: "Purpose" }
            },
            {
                question: "What drives you more:",
                optionA: { text: "Feeling restless if life becomes repetitive", driver: "Growth" },
                optionB: { text: "Feeling safe when life is orderly and planned", driver: "Control" }
            },
            {
                question: "What drives you more:",
                optionA: { text: "Winning recognition from society", driver: "Status" },
                optionB: { text: "Building warm, lasting friendships", driver: "Belonging" }
            },
            {
                question: "What drives you more:",
                optionA: { text: "Thriving on novelty and exploration", driver: "Growth" },
                optionB: { text: "Thriving on moral or spiritual fulfillment", driver: "Purpose" }
            },
            {
                question: "Which is more important to you:",
                optionA: { text: "Having control over every major decision in my life", driver: "Control" },
                optionB: { text: "Gaining recognition and high social standing", driver: "Status" }
            },
            {
                question: "Which is more important to you:",
                optionA: { text: "Belonging to a warm, supportive community", driver: "Belonging" },
                optionB: { text: "Expanding my knowledge and skills throughout life", driver: "Growth" }
            },
            {
                question: "Which is more important to you:",
                optionA: { text: "Living in freedom without external limits", driver: "Control" },
                optionB: { text: "Living in service of a higher moral calling", driver: "Purpose" }
            },
            {
                question: "Which is more important to you:",
                optionA: { text: "Becoming widely respected and influential", driver: "Status" },
                optionB: { text: "Continuously exploring and learning new things", driver: "Growth" }
            },
            {
                question: "Which is more important to you:",
                optionA: { text: "Building strong, enduring family bonds", driver: "Belonging" },
                optionB: { text: "Contributing to a mission bigger than myself", driver: "Purpose" }
            },
            {
                question: "What motivates you most:",
                optionA: { text: "Protecting my independence at all costs", driver: "Control" },
                optionB: { text: "Staying deeply connected to people I love", driver: "Belonging" }
            },
            {
                question: "What motivates you most:",
                optionA: { text: "Being honored for my achievements", driver: "Status" },
                optionB: { text: "Staying faithful to my deepest principles", driver: "Purpose" }
            },
            {
                question: "What motivates you most:",
                optionA: { text: "Embracing uncertainty to grow and explore", driver: "Growth" },
                optionB: { text: "Preferring predictability and safety", driver: "Control" }
            },
            {
                question: "What motivates you most:",
                optionA: { text: "Earning admiration from others", driver: "Status" },
                optionB: { text: "Being accepted and cared for as I am", driver: "Belonging" }
            },
            {
                question: "What motivates you most:",
                optionA: { text: "Advancing knowledge and discovery", driver: "Growth" },
                optionB: { text: "Living a life of devotion and service", driver: "Purpose" }
            }
        ];

        // Archetype Definitions
        const archetypes = {
            "Control": {
                name: "The Maverick",
                description: "You optimize for freedom, autonomy, and independence. You want to shape your own path without being constrained by rules, institutions, or expectations.",
                strengths: ["Independent thinking", "Risk-taking courage", "Entrepreneurial spirit", "Adaptability", "Self-reliance"],
                blindSpots: ["May resist collaboration", "Can struggle with structure", "Risk of isolation", "Difficulty with authority", "May avoid long-term commitments"]
            },
            "Growth": {
                name: "The Explorer",
                description: "You optimize for learning, mastery, and novelty. You thrive on curiosity and the pursuit of new challenges and experiences.",
                strengths: ["Creative innovation", "Quick learning", "Adaptability", "Future orientation", "Inspiring curiosity"],
                blindSpots: ["May lack focus", "Restlessness with routine", "Can neglect practical needs", "Difficulty with completion", "Risk of overwhelming others"]
            },
            "Status": {
                name: "The Achiever",
                description: "You optimize for recognition, prestige, and competitive success. You're motivated by proving yourself and standing out from others.",
                strengths: ["High ambition", "Results orientation", "Competitive drive", "Leadership potential", "Goal achievement"],
                blindSpots: ["External validation dependence", "Burnout risk", "May neglect relationships", "Comparison trap", "Stress under pressure"]
            },
            "Belonging": {
                name: "The Connector",
                description: "You optimize for relationships, intimacy, and community. You thrive when you feel bonded with others and part of something social.",
                strengths: ["Deep empathy", "Loyalty", "Emotional intelligence", "Harmony creation", "Supportive nature"],
                blindSpots: ["May sacrifice independence", "Conflict avoidance", "Over-dependence on others", "Difficulty with boundaries", "People-pleasing tendency"]
            },
            "Purpose": {
                name: "The Seeker",
                description: "You optimize for meaning, ideals, and transcendence. You're motivated by living for something larger than yourself and making a meaningful impact.",
                strengths: ["Strong principles", "Resilience in adversity", "Inspiring vision", "Values-driven decisions", "Long-term perspective"],
                blindSpots: ["May neglect practical needs", "Risk of rigidity", "Self-sacrifice tendency", "Idealistic expectations", "Difficulty with compromise"]
            },
            "Control+Growth": {
                name: "The Pioneer",
                description: "You're independent and driven by discovery. You want freedom to chart your own path and thrive in uncharted territory.",
                strengths: ["Bold innovation", "Risk-taking", "Independent exploration", "Adaptable leadership", "Creative problem-solving"],
                blindSpots: ["May resist structure", "Restlessness", "Difficulty with routine", "Can be scattered", "May avoid commitment"]
            },
            "Growth+Purpose": {
                name: "The Visionary",
                description: "You're an innovator with a mission. You explore not just for curiosity's sake, but to create meaningful impact.",
                strengths: ["Creative idealism", "Inspiring vision", "Future-oriented", "Values-driven innovation", "Motivating others"],
                blindSpots: ["Can overcommit", "May neglect practical needs", "Perfectionist tendencies", "Impatience with slow progress", "Risk of burnout"]
            },
            "Status+Control": {
                name: "The Power Broker",
                description: "You want influence on your own terms. Ambition and autonomy combine into a drive for leadership and authority.",
                strengths: ["Strategic thinking", "Leadership ambition", "Independent decision-making", "Persuasive ability", "Results focus"],
                blindSpots: ["Risk of manipulation", "May be controlling", "Workaholic tendencies", "Difficulty trusting others", "Can alienate people"]
            },
            "Status+Belonging": {
                name: "The Influencer",
                description: "You optimize for both admiration and connection. You want to be liked and respected, not just loved or just admired.",
                strengths: ["Social magnetism", "Network building", "Charismatic leadership", "People skills", "Bridge-building ability"],
                blindSpots: ["Image management pressure", "People-pleasing", "Authenticity challenges", "Fear of rejection", "May compromise values"]
            },
            "Belonging+Purpose": {
                name: "The Caregiver",
                description: "You live to nurture and serve. Relationships are infused with a sense of mission, and service feels like destiny.",
                strengths: ["Deep compassion", "Service orientation", "Loyalty", "Empathy", "Community building"],
                blindSpots: ["Self-neglect", "Burnout risk", "Boundary issues", "Difficulty saying no", "May enable others"]
            },
            "Balanced": {
                name: "The Integrator",
                description: "You show balance across multiple optimization drivers. You're flexible and can adapt your focus based on context and needs.",
                strengths: ["Flexibility", "Balanced perspective", "Adaptability", "Well-rounded approach", "Context sensitivity"],
                blindSpots: ["May lack clear direction", "Decision paralysis risk", "Less intense drive", "May seem unfocused", "Identity uncertainty"]
            }
        };

        // Assessment State
        let currentQuestion = 0;
        let answers = [];
        let scores = {
            Control: 0,
            Growth: 0,
            Status: 0,
            Belonging: 0,
            Purpose: 0
        };

        // Start Assessment
        function startAssessment() {
            showScreen('question-screen');
            displayQuestion();
        }

        // Display Current Question
        function displayQuestion() {
            const question = questions[currentQuestion];
            document.getElementById('question-text').textContent = question.question;
            document.getElementById('progress-text').textContent = `Question ${currentQuestion + 1} of ${questions.length}`;
            
            // Update progress bar
            const progress = ((currentQuestion + 1) / questions.length) * 100;
            document.getElementById('progress-bar').style.width = progress + '%';

            // Create options
            const optionsContainer = document.getElementById('options-container');
            optionsContainer.innerHTML = '';

            const optionA = createOption('A', question.optionA);
            const optionB = createOption('B', question.optionB);
            
            optionsContainer.appendChild(optionA);
            optionsContainer.appendChild(optionB);
        }

        // Create Option Element
        function createOption(letter, option) {
            const optionDiv = document.createElement('div');
            optionDiv.className = 'option';
            optionDiv.innerHTML = `<div class="option-text">${option.text}</div>`;
            
            optionDiv.addEventListener('click', () => selectAnswer(option));
            return optionDiv;
        }

        // Handle Answer Selection
        function selectAnswer(selectedOption) {
            answers.push(selectedOption);
            scores[selectedOption.driver]++;

            currentQuestion++;

            // Move to next question or show results
            if (currentQuestion < questions.length) {
                setTimeout(() => displayQuestion(), 300);
            } else {
                setTimeout(() => showResults(), 500);
            }
        }

        // Show Results
        function showResults() {
            calculateResults();
            showScreen('results-screen');
            animateResults();
        }

        // Calculate Final Results
        function calculateResults() {
            // Convert scores to percentages
            const totalQuestions = questions.length;
            const percentageScores = {};
            for (const [driver, score] of Object.entries(scores)) {
                percentageScores[driver] = Math.round((score / totalQuestions) * 100);
            }

            // Determine archetype
            const sortedDrivers = Object.entries(percentageScores).sort((a, b) => b[1] - a[1]);
            const topDriver = sortedDrivers[0];
            const secondDriver = sortedDrivers[1];

            let archetype;
            if (topDriver[1] >= secondDriver[1] + 15) {
                // Single dominant
                archetype = topDriver[0];
            } else if (topDriver[1] >= 30 && secondDriver[1] >= 30 && topDriver[1] - secondDriver[1] <= 10) {
                // Hybrid
                const hybridKey = [topDriver[0], secondDriver[0]].sort().join('+');
                const hybridKeyReverse = [secondDriver[0], topDriver[0]].sort().join('+');
                archetype = archetypes[hybridKey] ? hybridKey : hybridKeyReverse;
                if (!archetypes[archetype]) {
                    archetype = topDriver[0] + '+' + secondDriver[0];
                }
            } else {
                // Balanced or default to top
                const maxScore = Math.max(...Object.values(percentageScores));
                const minScore = Math.min(...Object.values(percentageScores));
                if (maxScore - minScore <= 15) {
                    archetype = "Balanced";
                } else {
                    archetype = topDriver[0];
                }
            }

            // Display results
            const archetypeData = archetypes[archetype] || archetypes[topDriver[0]];
            document.getElementById('archetype-type').textContent = archetypeData.name;
            document.getElementById('archetype-description').textContent = archetypeData.description;
            
            // Generate analysis
            generateVectorAnalysis(percentageScores, archetype);
            
            // Display optimization drivers
            displayOptimizationDrivers(percentageScores);
            
            // Display recommendations
            displayRecommendations(archetypeData);
            
            // Store results for export
            window.assessmentResults = {
                archetype: archetypeData.name,
                archetypeDescription: archetypeData.description,
                percentageScores,
                vectorAnalysis: generateVectorAnalysisText(percentageScores, archetype),
                strengths: archetypeData.strengths,
                blindSpots: archetypeData.blindSpots
            };
        }

        // Generate Vector Analysis
        function generateVectorAnalysis(percentageScores, archetype) {
            const analysis = generateVectorAnalysisText(percentageScores, archetype);
            document.getElementById('vector-analysis').textContent = analysis;
        }

        // Generate Vector Analysis Text
        function generateVectorAnalysisText(percentageScores, archetype) {
            const sortedDrivers = Object.entries(percentageScores).sort((a, b) => b[1] - a[1]);
            const topDriver = sortedDrivers[0];
            const secondDriver = sortedDrivers[1];
            const lowestDriver = sortedDrivers[4];

            let analysis = `Your optimization profile shows ${topDriver[0]} as your primary driver (${topDriver[1]}%), `;
            
            if (topDriver[1] - secondDriver[1] <= 10 && secondDriver[1] >= 25) {
                analysis += `with strong secondary optimization for ${secondDriver[0]} (${secondDriver[1]}%). `;
                analysis += `This combination creates a dynamic where you seek both ${topDriver[0].toLowerCase()} and ${secondDriver[0].toLowerCase()}, `;
                analysis += `which can be mutually reinforcing or create interesting tensions to navigate.`;
            } else {
                analysis += `significantly outweighing other factors. `;
                analysis += `While you show some optimization for ${secondDriver[0]} (${secondDriver[1]}%), `;
                analysis += `your life choices are primarily guided by your drive for ${topDriver[0].toLowerCase()}.`;
            }

            if (lowestDriver[1] <= 10) {
                analysis += ` You show minimal optimization for ${lowestDriver[0]} (${lowestDriver[1]}%), `;
                analysis += `which suggests this is not a major factor in your decision-making process.`;
            }

            return analysis;
        }

        // Display Optimization Drivers
        function displayOptimizationDrivers(percentageScores) {
            const driversContainer = document.getElementById('optimization-drivers');
            driversContainer.innerHTML = '';

            const driverDescriptions = {
                Control: 'Autonomy & Freedom',
                Growth: 'Learning & Mastery',
                Status: 'Recognition & Achievement',
                Belonging: 'Relationships & Community',
                Purpose: 'Meaning & Values'
            };

            for (const [driver, score] of Object.entries(percentageScores)) {
                const driverDiv = document.createElement('div');
                driverDiv.className = 'trait-bar';
                
                driverDiv.innerHTML = `
                    <div class="trait-label">${driverDescriptions[driver]}</div>
                    <div class="trait-progress">
                        <div class="trait-fill" data-width="${score}"></div>
                    </div>
                    <div class="trait-score">${score}%</div>
                `;
                
                driversContainer.appendChild(driverDiv);
            }
        }

        // Display Recommendations
        function displayRecommendations(archetypeData) {
            const strengthsContainer = document.getElementById('recommendations-strengths');
            const blindSpotsContainer = document.getElementById('recommendations-blindspots');
            
            strengthsContainer.innerHTML = '';
            blindSpotsContainer.innerHTML = '';

            archetypeData.strengths.forEach(item => {
                const li = document.createElement('li');
                li.textContent = item;
                strengthsContainer.appendChild(li);
            });

            archetypeData.blindSpots.forEach(item => {
                const li = document.createElement('li');
                li.textContent = item;
                blindSpotsContainer.appendChild(li);
            });
        }

        // Animate Results
        function animateResults() {
            setTimeout(() => {
                const traitFills = document.querySelectorAll('.trait-fill');
                traitFills.forEach(fill => {
                    const width = fill.dataset.width;
                    fill.style.width = width + '%';
                });
            }, 500);
        }

        // Export Functions
        function downloadResults() {
            const results = window.assessmentResults;
            const personalMessage = document.getElementById('personal-message').value;
            const timestamp = new Date().toLocaleString();
            const currentURL = window.location.href;
            const fileTimestamp = new Date().toISOString().slice(0, 19).replace(/[:-]/g, '').replace('T', '_');
            
            const htmlContent = `
            <!DOCTYPE html>
            <html>
            <head>
                <meta charset="UTF-8">
                <title>OVM Assessment Results</title>
                <style>
                    body { 
                        font-family: Arial, sans-serif; 
                        line-height: 1.6; 
                        color: #333; 
                        max-width: 800px; 
                        margin: 0 auto; 
                        padding: 20px;
                        background: white;
                    }
                    .header { 
                        text-align: center; 
                        border-bottom: 3px solid #667eea; 
                        padding-bottom: 20px; 
                        margin-bottom: 30px;
                    }
                    .header h1 { 
                        color: #667eea; 
                        font-size: 2.5em; 
                        margin: 0;
                    }
                    .archetype-section { 
                        background: linear-gradient(135deg, #667eea, #764ba2); 
                        color: white; 
                        padding: 30px; 
                        border-radius: 15px; 
                        text-align: center; 
                        margin-bottom: 30px;
                    }
                    .archetype-type { 
                        font-size: 3em; 
                        font-weight: bold; 
                        margin: 10px 0;
                    }
                    .section { 
                        margin-bottom: 30px; 
                        padding: 20px; 
                        background: #f8f9fa; 
                        border-radius: 10px; 
                        border-left: 5px solid #667eea;
                    }
                    .section h2 { 
                        color: #667eea; 
                        margin-top: 0;
                        font-size: 1.5em;
                    }
                    .driver-item { 
                        display: flex; 
                        justify-content: space-between; 
                        margin: 10px 0; 
                        padding: 8px 0;
                        border-bottom: 1px solid #dee2e6;
                    }
                    .recommendations { 
                        display: grid; 
                        grid-template-columns: 1fr 1fr; 
                        gap: 20px; 
                        margin-top: 20px;
                    }
                    .rec-column { 
                        background: white; 
                        padding: 20px; 
                        border-radius: 10px; 
                        border-left: 5px solid #48bb78;
                    }
                    .rec-column.blindspots { 
                        border-left-color: #e53e3e;
                    }
                    .rec-column h3 { 
                        margin-top: 0; 
                        color: #2d3748;
                    }
                    .rec-column ul { 
                        list-style: none; 
                        padding: 0;
                    }
                    .rec-column li { 
                        margin: 8px 0; 
                        padding-left: 20px; 
                        position: relative;
                    }
                    .rec-column li:before { 
                        content: "✓"; 
                        position: absolute; 
                        left: 0; 
                        color: #48bb78; 
                        font-weight: bold;
                    }
                    .rec-column.blindspots li:before { 
                        content: "⚠"; 
                        color: #e53e3e;
                    }
                    .personal-message {
                        background: linear-gradient(135deg, #667eea, #764ba2);
                        color: white;
                        padding: 20px;
                        border-radius: 10px;
                        margin: 20px 0;
                    }
                    .footer { 
                        margin-top: 50px; 
                        padding-top: 20px; 
                        border-top: 2px solid #dee2e6; 
                        text-align: center; 
                        color: #6c757d; 
                        font-size: 0.9em;
                    }
                    @media print {
                        body { margin: 0; padding: 15px; }
                        .recommendations { grid-template-columns: 1fr; }
                    }
                </style>
            </head>
            <body>
                <div class="header">
                    <h1>OVM Assessment Results</h1>
                    <p style="margin: 10px 0; color: #667eea; font-size: 1.2em;">Optimization Vectors Model</p>
                </div>
                
                <div class="archetype-section">
                    <div class="archetype-type">${results.archetype}</div>
                    <p style="font-size: 1.2em; margin: 0;">${results.archetypeDescription}</p>
                </div>

                <div class="section">
                    <h2>Optimization Vector Analysis</h2>
                    <p>${results.vectorAnalysis}</p>
                </div>

                <div class="section">
                    <h2>Your Optimization Drivers</h2>
                    <div class="driver-item">
                        <span><strong>Control (Autonomy & Freedom):</strong></span>
                        <span><strong>${results.percentageScores.Control}%</strong></span>
                    </div>
                    <div class="driver-item">
                        <span><strong>Growth (Learning & Mastery):</strong></span>
                        <span><strong>${results.percentageScores.Growth}%</strong></span>
                    </div>
                    <div class="driver-item">
                        <span><strong>Status (Recognition & Achievement):</strong></span>
                        <span><strong>${results.percentageScores.Status}%</strong></span>
                    </div>
                    <div class="driver-item">
                        <span><strong>Belonging (Relationships & Community):</strong></span>
                        <span><strong>${results.percentageScores.Belonging}%</strong></span>
                    </div>
                    <div class="driver-item">
                        <span><strong>Purpose (Meaning & Values):</strong></span>
                        <span><strong>${results.percentageScores.Purpose}%</strong></span>
                    </div>
                </div>

                <div class="section">
                    <h2>Life & Career Insights</h2>
                    <div class="recommendations">
                        <div class="rec-column">
                            <h3>✓ Strengths & Opportunities</h3>
                            <ul>
                                ${results.strengths.map(item => `<li>${item}</li>`).join('')}
                            </ul>
                        </div>
                        <div class="rec-column blindspots">
                            <h3>⚠ Potential Blind Spots</h3>
                            <ul>
                                ${results.blindSpots.map(item => `<li>${item}</li>`).join('')}
                            </ul>
                        </div>
                    </div>
                </div>

                ${personalMessage ? `
                <div class="personal-message">
                    <h3>Personal Reflection</h3>
                    <p>${personalMessage.replace(/\n/g, '<br>')}</p>
                </div>
                ` : ''}

                <div class="footer">
                    <p><strong>Generated on:</strong> ${timestamp}</p>
                    <p><strong>Take your free OVM assessment:</strong> <a href="${currentURL}" target="_blank">${currentURL}</a></p>
                    <p><em>Based on the Optimization Vectors Model (OVM) - A scientific framework for understanding human motivation</em></p>
                </div>
            </body>
            </html>`;

            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ovm-assessment-${results.archetype.replace(/\s+/g, '-').toLowerCase()}-${fileTimestamp}.html`;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        function shareAsImage() {
            const resultsContent = document.querySelector('#results-screen .results-screen');
            if (!resultsContent) {
                alert('Results content not found. Please complete the assessment first.');
                return;
            }
        
            // Temporarily hide the buttons for the screenshot
            const buttonsSection = document.querySelector('.export-buttons');
            const restartButton = document.querySelector('.restart-btn');
            const originalDisplayButtons = buttonsSection ? buttonsSection.style.display : null;
            const originalDisplayRestart = restartButton ? restartButton.style.display : null;
            if (buttonsSection) buttonsSection.style.display = 'none';
            if (restartButton) restartButton.style.display = 'none';
            
            // Create footer for the image
            const footerElement = document.createElement('div');
            footerElement.style.textAlign = 'center';
            footerElement.style.padding = '20px 0 10px';
            footerElement.style.borderTop = '1px solid #e2e8f0';
            footerElement.style.color = '#718096';
            footerElement.style.fontSize = '12px';
            footerElement.innerHTML = `
                <p>Generated on: ${new Date().toLocaleString()}</p>
                <p>Take your free OVM assessment: <a href="${window.location.href}">${window.location.href}</a></p>
                <p><em>Based on the Optimization Vectors Model (OVM)</em></p>
            `;
            
            // Clone the results screen content
            const contentToCapture = resultsContent.cloneNode(true);
            contentToCapture.style.backgroundColor = 'white';
            contentToCapture.style.padding = '40px';
            contentToCapture.style.minHeight = 'auto';
            contentToCapture.appendChild(footerElement);
        
            // Create temporary container
            const tempContainer = document.createElement('div');
            tempContainer.style.position = 'absolute';
            tempContainer.style.left = '-9999px';
            tempContainer.style.top = '-9999px';
            tempContainer.style.width = '600px';
            tempContainer.style.background = 'white';
            tempContainer.appendChild(contentToCapture);
            document.body.appendChild(tempContainer);
        
            html2canvas(contentToCapture, {
                scale: 2,
                backgroundColor: null
            }).then(canvas => {
                tempContainer.remove();
        
                const timestamp = new Date().toISOString().slice(0, 19).replace(/[:-]/g, '').replace('T', '_');
                const filename = `ovm-assessment-results-${timestamp}.png`;
                const shareMessage = generateShareMessage(window.assessmentResults, window.location.href);
        
                // Restore button visibility
                if (buttonsSection) buttonsSection.style.display = originalDisplayButtons;
                if (restartButton) restartButton.style.display = originalDisplayRestart;
        
                // Check for Web Share API support
                if (navigator.share) {
                    canvas.toBlob(blob => {
                        const file = new File([blob], filename, { type: 'image/png' });
                        navigator.share({
                            files: [file],
                            title: 'My OVM Assessment Results',
                            text: shareMessage
                        }).catch(error => {
                            console.error('Sharing failed:', error);
                            downloadCanvasImage(canvas, filename);
                            alert("Sharing failed. The image has been downloaded instead.");
                        });
                    });
                } else {
                    downloadCanvasImage(canvas, filename);
                    if (navigator.clipboard && shareMessage) {
                        navigator.clipboard.writeText(shareMessage).then(() => {
                            alert("Image downloaded! A shareable message has been copied to your clipboard.");
                        }).catch(err => {
                            console.error('Clipboard write failed:', err);
                            alert("Image downloaded! You'll need to manually copy the share message.");
                        });
                    } else {
                        alert("Image downloaded! Your browser doesn't support the 'Share' function or clipboard access.");
                    }
                }
            }).catch(error => {
                console.error('Error generating image:', error);
                if (buttonsSection) buttonsSection.style.display = originalDisplayButtons;
                if (restartButton) restartButton.style.display = originalDisplayRestart;
                alert('Failed to create a shareable image. Please try again.');
            });
        }

        function downloadCanvasImage(canvas, filename) {
            const link = document.createElement('a');
            link.download = filename;
            link.href = canvas.toDataURL('image/png');
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function generateShareMessage(results, url) {
            const personalMessage = document.getElementById('personal-message').value;
            const messages = [
                `Just discovered I'm ${results.archetype}! 🎯 The OVM assessment revealed fascinating insights about what truly drives my decisions.`,
                `My optimization profile shows I'm ${results.archetype}! 💫 Really eye-opening to understand my core motivational drivers.`,
                `Took the OVM assessment and learned I'm ${results.archetype}! 🧠 The insights about my optimization patterns were spot-on.`,
                `Found out I'm ${results.archetype} through this comprehensive motivation assessment! ✨ Understanding what I optimize for is so valuable.`
            ];
            
            const randomMessage = messages[Math.floor(Math.random() * messages.length)];
            
            let shareText = `${randomMessage}\n\nDiscover what drives your life choices with the free OVM Assessment: ${url}\n\n#OVM #OptimizationVectors #PersonalityAssessment #Motivation #${results.archetype.replace(/\s+/g, '')}`;
            
            if (personalMessage && personalMessage.trim()) {
                shareText += `\n\nMy reflection: "${personalMessage.trim()}"`;
            }
            
            return shareText;
        }

        // Utility Functions
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        function restartAssessment() {
            // Reset all variables
            currentQuestion = 0;
            answers = [];
            scores = {
                Control: 0,
                Growth: 0,
                Status: 0,
                Belonging: 0,
                Purpose: 0
            };
            
            // Clear personal message
            document.getElementById('personal-message').value = '';
            
            // Show welcome screen
            showScreen('welcome-screen');
        }
    </script>
</body>
</html>
